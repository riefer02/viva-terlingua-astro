---
import Layout from '@/layouts/Layout.astro';
import CardGrid from '@/components/CardGrid.astro';
import strapi from '@/lib/api/strapi-client';
import type {
  LocalAttractionsLocalAttractionListResponse,
  LocalAttractionsLocalAttraction,
} from '@/types/strapi';

// Fetch local attractions data
const response = await strapi.find<LocalAttractionsLocalAttractionListResponse>(
  'local-attractions',
  {
    populate: {
      marqueeImage: {
        populate: '*',
      },
    },
  }
);

if (!response?.data) {
  throw new Error('Local attractions data not found');
}

const attractions = (response.data as LocalAttractionsLocalAttraction[]).map(
  (item) => ({
    ...item,
    id: item.id,
    marqueeImage: item.marqueeImage,
    name: item.name || '',
    description: item.description || '',
    slug: item.slug || '',
  })
);
---

<Layout
  title="Local Attractions"
  description="Discover amazing local attractions around A Bowl of Red"
>
  <main class="container mx-auto px-4 py-12">
    <h1 class="mb-8 text-4xl font-bold">Local Attractions</h1>
    <CardGrid items={attractions} type="attraction" />
  </main>
</Layout>
