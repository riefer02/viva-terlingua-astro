---
import strapi from '../lib/api/strapi-client';

let response;
let error;

try {
  console.log('Fetching events from Strapi...');
  response = await strapi.find('events', {
    pagination: {
      page: 1,
      pageSize: 10,
    },
    sort: ['startDateTime:desc'],
    populate: '*',
  });

  console.log('Response:', JSON.stringify(response, null, 2));
} catch (err) {
  error = err;
  console.error('Error fetching events:', err);
  if (err instanceof Error) {
    console.log('Error details:', err.message);
  }
}
---

<div class="p-8">
  <h1 class="text-2xl font-bold mb-4">API Test Page</h1>
  <p class="mb-4">Raw API Response:</p>

  {
    error && (
      <div class="mt-4 p-4 bg-red-100 text-red-700 rounded">
        <p>Error: {error instanceof Error ? error.message : 'Unknown error occurred'}</p>
      </div>
    )
  }

  {
    response && (
      <div class="mt-4">
        <pre class="bg-gray-100 p-4 rounded overflow-auto">{JSON.stringify(response, null, 2)}</pre>
      </div>
    )
  }
</div>
